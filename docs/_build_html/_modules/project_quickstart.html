<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>project_quickstart &#8212; project_quickstart 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for project_quickstart</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&#39;&#39;&#39;project_quickstart.py - setup a new python based project</span>
<span class="sd">===========================================================</span>

<span class="sd">:Author: Antonio Berlanga-Taylor</span>
<span class="sd">:Release: $Id$</span>
<span class="sd">:Date: |today|</span>


<span class="sd">Purpose</span>
<span class="sd">=======</span>

<span class="sd">This script creates a python data science project template. The main idea is</span>
<span class="sd">to</span>
<span class="sd">be able to easily turn a project into a package with software testing, version</span>
<span class="sd">control, reporting, docs, etc. It has:</span>

<span class="sd">    Reproducibility concepts in mind</span>
<span class="sd">    Ruffus as a pipeline tool and CGAT tools for support</span>
<span class="sd">    Python programming and packaging</span>
<span class="sd">    restructuredText and Sphinx for reporting</span>
<span class="sd">    Travis and tox for testing</span>
<span class="sd">    Conda and Docker for management and development</span>
<span class="sd">    GitHub for version control</span>

<span class="sd">I&#39;ve additionally put some basic instructions/reminders to link GitHub with:</span>

<span class="sd">    ReadtheDocs</span>
<span class="sd">    Zenodo (for archiving your code and generating a DOI)</span>
<span class="sd">    Travis CI.</span>

<span class="sd">Once you&#39;ve quickstarted your project you can run script_quickstart.py to</span>
<span class="sd">quickly create a Python or R script template.</span>

<span class="sd">For a pipeline quickstart based on a Ruffus and CGAT framework see also:</span>
<span class="sd">https://github.com/CGATOxford/CGATPipelines/blob/master/scripts/pipeline_quickstart.py</span>
<span class="sd">(on which this code is based on)</span>


<span class="sd">Usage and Options</span>
<span class="sd">=================</span>

<span class="sd">Create a new directory, subfolders and files in the current directory that will</span>
<span class="sd">help quickstart your data science project with packaging, testing, scripts and</span>
<span class="sd">other templates.</span>

<span class="sd">.. These are using docopt: http://docopt.org/</span>
<span class="sd">.. https://github.com/docopt/docopt</span>
<span class="sd">.. An example for loading arguments from an INI file:</span>
<span class="sd">.. https://github.com/docopt/docopt/blob/master/examples/config_file_example.py</span>
<span class="sd">.. http://docopt.readthedocs.io/en/latest/#help-message-format</span>
<span class="sd">.. Basic reminders for docopt:</span>
<span class="sd">    Use two spaces to separate options with their informal description</span>
<span class="sd">    () are required, [] are optional</span>
<span class="sd">    Default values are specified in the Options section with eg [default:</span>
<span class="sd">    xxx.log]</span>

<span class="sd">.. See also Schema for input argument validation, e.g.:</span>
<span class="sd">    https://github.com/docopt/docopt/blob/master/examples/validation_example.py</span>

<span class="sd">.. Usage pattern in docopt can&#39;t have empty lines and ends with an empty line.</span>
<span class="sd">   The first word after usage\: is interpreted as the program&#39;s name (e.g.</span>
<span class="sd">   &#39;python xxx.py&#39; makes it think your programme is called &#39;python&#39; with</span>
<span class="sd">   option &#39;xxx.py&#39;)</span>
<span class="sd">.. docopt reads multi-line descriptions in Options so 80 character lines can be</span>
<span class="sd">   wrapped.</span>
<span class="sd">.. &#39;Usage&#39; and &#39;Options&#39; case insensitive and followed by &#39;:&#39; are recognised by</span>
<span class="sd">   docopt in the docstrings.</span>
<span class="sd">.. docopt</span>


<span class="sd">Usage:</span>
<span class="sd">       project_quickstart.py [--project-name=&lt;project_name&gt; | -n</span>
<span class="sd">                              &lt;project_name&gt;] ...</span>
<span class="sd">       project_quickstart.py [--update | -u]</span>
<span class="sd">       project_quickstart.py [--script-python=&lt;script_name&gt;]</span>
<span class="sd">       project_quickstart.py [--script-R=&lt;script_name&gt;]</span>
<span class="sd">       project_quickstart.py [-f | --force]</span>
<span class="sd">       project_quickstart.py [-h | --help]</span>
<span class="sd">       project_quickstart.py [--version]</span>
<span class="sd">       project_quickstart.py [--quiet]</span>
<span class="sd">       project_quickstart.py [--verbose]</span>
<span class="sd">       project_quickstart.py [--log=&lt;log_file&gt; | -L &lt;log_file&gt;]</span>
<span class="sd">       project_quickstart.py [--dry-run]</span>

<span class="sd">Options:</span>
<span class="sd">    --project-name=DIR -n DIR     Starts a new project, &#39;project_&#39; is prefixed.</span>
<span class="sd">    --update -u                   Propagate changes made in project_quickstart.ini</span>
<span class="sd">    --script-python=FILE          Create a python script template, &#39;.py&#39; is appended.</span>
<span class="sd">    --script-R=FILE               Create an R script template, &#39;.R&#39; is appended.</span>
<span class="sd">    -f --force                    Take care, forces to overwrite files and directories.</span>
<span class="sd">    -h --help                     Show this screen.</span>
<span class="sd">    --version                     Show version.</span>
<span class="sd">    --quiet                       Print less text.</span>
<span class="sd">    --verbose                     Print more text.</span>
<span class="sd">    -L FILE --log=FILE            Log file name. [default: project_quickstart.log]</span>
<span class="sd">    --dry-run                     Print to screen only.</span>

<span class="sd">Documentation</span>
<span class="sd">=============</span>

<span class="sd">.. todo::</span>

<span class="sd">  Add docs</span>
<span class="sd">  Add tree structure</span>

<span class="sd">Code</span>
<span class="sd">====</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1">##############################</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="k">import</span> <span class="n">copytree</span><span class="p">,</span> <span class="n">ignore_patterns</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">string</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">configparser</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>  <span class="c1"># Py2 to Py3</span>
    <span class="kn">import</span> <span class="nn">ConfigParser</span> <span class="k">as</span> <span class="nn">configparser</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">StringIO</span> <span class="k">import</span> <span class="n">StringIO</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>  <span class="c1"># Python 3</span>
    <span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="n">StringIO</span>

<span class="c1"># Modules not in core library:</span>
<span class="c1"># import CGAT.Experiment as E</span>
<span class="kn">import</span> <span class="nn">docopt</span>


<span class="c1"># project_quickstart.py modules:</span>
<span class="c1"># import quickstart_utilities.py as quickUtils</span>


<span class="c1"># Check configuration and print to standard out</span>
<span class="c1"># See:</span>
<span class="c1"># https://github.com/CGATOxford/CGATPipelines/blob/master/CGATPipelines/</span>
<span class="c1"># Pipeline/Parameters.py</span>
<span class="c1"># https://github.com/CGATOxford/cgat/blob/master/CGAT/Experiment.py</span>

<span class="c1"># Global variable for configuration file (&#39;.ini&#39;)</span>
<span class="c1"># allow_no_value addition is from:</span>
<span class="c1"># https://github.com/docopt/docopt/blob/master/examples/config_file_example.py</span>
<span class="c1"># By using `allow_no_value=True` we are allowed to</span>
<span class="c1"># write `--force` instead of `--force=true` below.</span>
<span class="n">CONFIG</span> <span class="o">=</span> <span class="n">configparser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">(</span><span class="n">allow_no_value</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>


<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">class TriggeredDefaultFactory:</span>
<span class="sd">    with_default = False</span>

<span class="sd">    def __call__(self):</span>
<span class="sd">        if TriggeredDefaultFactory.with_default:</span>
<span class="sd">            return str()</span>
<span class="sd">        else:</span>
<span class="sd">            print(&quot;Missing argument, see python project_quickstart.py --help&quot;)</span>
<span class="sd">            raise KeyError(&quot;Missing parameter accessed&quot;)</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1"># Global variable for parameter interpolation in commands</span>
<span class="c1"># This is a dictionary that can be switched between defaultdict</span>
<span class="c1"># and normal dict behaviour.</span>
<span class="c1">#PARAMS = collections.defaultdict(TriggeredDefaultFactory())</span>

<span class="c1"># patch - if --help or -h in command line arguments,</span>
<span class="c1"># switch to a default dict to avoid missing paramater</span>
<span class="c1"># failures</span>

<span class="c1"># TO DO: (see E.py)</span>
<span class="c1"># if &quot;--help&quot; in sys.argv or &quot;-h&quot; in sys.argv:</span>
<span class="c1">#    TriggeredDefaultFactory.with_default = True</span>

<span class="n">CONFIG</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;project_quickstart.ini&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">CONFIG</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">CONFIG</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

<span class="c1"># docopt requires Nones to be passed as False:</span>
<span class="c1"># quickUtils.load_ini_config()</span>
<span class="c1"># results = ini_values</span>

<span class="c1">##############################</span>


<span class="c1">##############################</span>
<span class="c1"># To delete:</span>
<span class="n">prog_version</span> <span class="o">=</span> <span class="s1">&#39;0.1&#39;</span>

<div class="viewcode-block" id="main"><a class="viewcode-back" href="../project_quickstart.html#project_quickstart.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; with docopt main() expects a dictionary with arguments from docopt()</span>
<span class="sd">    docopt will automatically check your docstrings for usage, set -h, etc.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">docopt_error_msg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;Exited due to error. &#39;</span>  <span class="c1"># + Options in place:&#39;</span>
                           <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                          <span class="c1">#+  str(docopt.docopt(__doc__))</span>
                          <span class="c1">#+  &#39;\n&#39;</span>
                           <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Parse arguments, use file docstring as a parameter definition:</span>
        <span class="c1"># These are required, exit with message if not present:</span>
        <span class="c1">#if not options[&#39;--project-name&#39;]:</span>
        <span class="c1">#    print(docopt_error_msg)</span>
        <span class="c1">#    print(&#39;&#39;&#39; Error in  the options given, a project name is required, such</span>
        <span class="c1">#              as &quot;super&quot;, which will be appended to &quot;project_&quot;.</span>
        <span class="c1">#              Try python project_quickstart.py --help .&#39;&#39;&#39;)</span>
        <span class="c1">#    sys.exit()</span>
        <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--project-name&#39;</span><span class="p">]:</span>
            <span class="c1"># py3.6 formatting:</span>
            <span class="n">project_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;--project-name&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&quot;</span><span class="p">)</span>
            <span class="n">project_root</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;project_</span><span class="si">{project_name}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># TO DO: add --path ? To avoid problems with searching for the &#39;templates&#39; folder?</span>
        <span class="c1"># See path search below</span>

        <span class="c1"># These arguments are optional:</span>
        <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--force&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Force overwriting directories and files&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Option not in use at the moment&#39;</span><span class="p">)</span>
            <span class="k">pass</span>  <span class="c1"># TO DO</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--log&#39;</span><span class="p">]:</span>
    <span class="c1">#        log = str(options[&quot;--log&quot;]).strip(&#39;[]&#39;).strip(&quot;&#39;&#39;&quot;)</span>
            <span class="n">log</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;project_quickstart.log&#39;</span><span class="p">)</span>
            <span class="k">pass</span>  <span class="c1"># TO DO, script log function</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;--log&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--update&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;&#39; After manually editing the ini file run to</span>
<span class="s1">                    propagate changes.&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Option not in use at the moment&#39;</span><span class="p">)</span>
            <span class="k">pass</span>  <span class="c1"># TO DO</span>
        <span class="c1"># Is len()&gt; 0 needed? docopt takes care of missing arg? TO DO</span>
        <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--script-python&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;--script-python&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;&#39; Creating a Python script template. A softlink is</span>
<span class="s1">                  created in the current working directory and the</span>
<span class="s1">                  actual file in xxx/code/scripts/ &#39;&#39;&#39;</span><span class="p">)</span>
            <span class="c1"># py3.5 formatting:</span>
<span class="c1">#            script_name = str(&#39;{}.py&#39;).format.options[&#39;--script-python&#39;]</span>
            <span class="c1"># py3.6:</span>
            <span class="n">script_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;--script-python&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&quot;</span><span class="p">)</span>
            <span class="n">script_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{script_name}</span><span class="s1">.py&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">script_name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--script-python&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;--script-python&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">docopt_error_msg</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;&#39; You need to provide a script name. This will be prefixed to</span>
<span class="s1">                  &quot;.py&quot; &#39;&#39;&#39;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--script-R&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;--script-R&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;&#39; Creating an R script template. A softlink is</span>
<span class="s1">                  created in the current working directory and the</span>
<span class="s1">                  actual file in xxx/code/scripts/ &#39;&#39;&#39;</span><span class="p">)</span>
            <span class="n">script_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;--script-R&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;&#39;&#39;&quot;</span><span class="p">)</span>
            <span class="n">script_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;</span><span class="si">{script_name}</span><span class="s1">.R&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">script_name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--script-R&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;--script-R&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">docopt_error_msg</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;&#39; You need to provide a script name. This will be prefixed to</span>
<span class="s1">                  &quot;.R&quot; &#39;&#39;&#39;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--dry-run&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dry run, only print what folders will be created.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Option not in use at the moment&#39;</span><span class="p">)</span>
            <span class="k">pass</span>  <span class="c1"># TO DO</span>

        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;Options in use: &#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">options</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Handle exceptions:</span>
    <span class="k">except</span> <span class="n">docopt</span><span class="o">.</span><span class="n">DocoptExit</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">docopt_error_msg</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;&#39; Invalid option or missing argument,</span>
<span class="s1">        try project_quickstart.py --help&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="k">raise</span>

    <span class="c1"># Set up default paths, directoy and file names:</span>
    <span class="n">project_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">project_root</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">project_dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">project_dir</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">docopt_error_msg</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;&#39;&#39;The directory with the name </span><span class="si">{project_root}</span><span class="s1"> already exists.</span>
<span class="s1">                    Use --force to overwrite.&#39;&#39;&#39;</span>
                  <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                  <span class="p">))</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

    <span class="c1"># Get locations of source code</span>
    <span class="c1"># os.path.join note: a subsequent argument with an &#39;/&#39; discards anything</span>
    <span class="c1"># before it</span>
    <span class="c1"># For function to search path see: </span>
    <span class="c1"># http://stackoverflow.com/questions/4519127/setuptools-package-data-folder-location</span>

    <span class="n">_ROOT</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">getDir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Search path for the &#39;xxxx&#39; directory for copying within cwd &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_ROOT</span><span class="p">,</span> <span class="n">f</span><span class="s1">&#39;project_quickstart-</span><span class="si">{prog_version}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

    <span class="n">template_dir</span> <span class="o">=</span> <span class="n">getDir</span><span class="p">(</span><span class="s1">&#39;templates&#39;</span><span class="p">)</span>
    <span class="n">project_template</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">template_dir</span><span class="p">,</span> <span class="s1">&#39;project_template&#39;</span><span class="p">)</span>

    <span class="n">dirs_to_use</span> <span class="o">=</span> <span class="p">[</span><span class="n">template_dir</span><span class="p">,</span>
                   <span class="n">project_template</span>
                   <span class="p">]</span>

    <span class="c1"># Sanity check:</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs_to_use</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">docopt_error_msg</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;&#39;&#39; The directory:</span>
<span class="s1">                       </span><span class="si">{d}</span><span class="s1"></span>
<span class="s1">                       does not exist.</span>
<span class="s1">                       Are the paths correct? Did the programme install in the</span>
<span class="s1">                       right location?</span>
<span class="s1">                       &#39;bin&#39; dir should be where project_quickstart installed,</span>
<span class="s1">                       &#39;templates&#39; and &#39;project_template&#39; come with this</span>
<span class="s1">                       package.</span>
<span class="s1">                   &#39;&#39;&#39;</span> <span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

    <span class="c1"># Get the names for the directories to create for the project skeleton:</span>
    <span class="n">manuscript_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;manuscript&#39;</span><span class="p">)</span>
    <span class="n">code_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;code&#39;</span><span class="p">)</span>
    <span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
    <span class="n">results_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;results_1&#39;</span><span class="p">)</span>
    <span class="n">script_template_py</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;python_script_template.py&#39;</span><span class="p">)</span>
    <span class="n">script_template_R</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;R_script_template.R&#39;</span><span class="p">)</span>

    <span class="n">dirnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">manuscript_dir</span><span class="p">,</span>
               <span class="c1"># code_dir, # leave out as shutil.copytree needs to create the</span>
               <span class="c1"># shutit root dir, otherwise files are not copied</span>
                <span class="n">data_dir</span><span class="p">,</span>
                <span class="n">results_dir</span>
                <span class="p">]</span>

    <span class="c1"># Sanity check:</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirnames</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">docopt_error_msg</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;&#39;&#39; The directory:</span>
<span class="s1">                       </span><span class="si">{dir_path}</span><span class="s1"></span>
<span class="s1">                       already exists.</span>
<span class="s1">                       To overwrite use --force.</span>
<span class="s1">                   &#39;&#39;&#39;</span> <span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

    <span class="c1"># If directory paths are OK, continue:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;Paths in use:&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
              <span class="o">+</span> <span class="n">template_dir</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
              <span class="o">+</span> <span class="n">project_template</span>
              <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
              <span class="o">+</span> <span class="n">f</span><span class="s1">&#39;Creating the project structure for </span><span class="si">{project_name}</span><span class="s1"> in:&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
              <span class="o">+</span> <span class="n">project_dir</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
          <span class="p">)</span>

    <span class="c1"># Create directories:</span>
    <span class="c1"># TO DO: pass these from ini file</span>
    <span class="c1"># Add hardcoded directories first for now:</span>
    <span class="n">dirnames</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/raw&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)])</span>
    <span class="n">dirnames</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/processed&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)])</span>
    <span class="n">dirnames</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/external&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)])</span>

    <span class="n">tree_dir</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">):</span>
        <span class="n">tree_dir</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dirnames</span><span class="p">)]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">docopt_error_msg</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;The directory </span><span class="si">{d}</span><span class="s1"> already exists, use --force to overwrite.&#39;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

    <span class="c1"># Copy files from template directory:</span>
    <span class="k">def</span> <span class="nf">projectTemplate</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Copy across project template files for</span>
<span class="sd">        a Python/GitHub/etc setup.</span>
<span class="sd">        TO DO: &#39;code&#39; dir is hard coded, change to ini parameter later</span>
<span class="sd">        The intention is to use the &#39;code&#39; dir as a</span>
<span class="sd">        GitHub/packageable directory</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--force&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">docopt_error_msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">                          Directory </span><span class="si">{}</span><span class="s1"> already exists - not overwriting.</span>
<span class="s1">                          see --help or use --force</span>
<span class="s1">                          to overwrite.</span>
<span class="s1">                          &#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
                          <span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">ignore</span> <span class="o">=</span> <span class="n">ignore_patterns</span><span class="p">(</span><span class="s1">&#39;.dir_bash*&#39;</span><span class="p">))</span>

    <span class="n">projectTemplate</span><span class="p">(</span><span class="n">project_template</span><span class="p">,</span> <span class="n">code_dir</span><span class="p">)</span>

    <span class="c1"># Copy across individual files outside of the &#39;templates&#39; dir:</span>
    <span class="k">def</span> <span class="nf">copySingleFiles</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">string1</span><span class="p">,</span> <span class="n">string2</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Copy the manuscript and lab_notebook templates</span>
<span class="sd">        to the &#39;manuscript&#39; directory.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">string1</span> <span class="ow">in</span> <span class="n">f</span> <span class="ow">or</span> <span class="n">string2</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">files</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">f</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">files</span><span class="p">):</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">src</span><span class="p">,</span><span class="n">f</span><span class="p">),</span> <span class="n">dst</span><span class="p">)</span>

    <span class="n">copySingleFiles</span><span class="p">(</span><span class="n">template_dir</span><span class="p">,</span> <span class="n">manuscript_dir</span><span class="p">,</span> <span class="s1">&#39;rst&#39;</span><span class="p">,</span> <span class="s1">&#39;rst&#39;</span><span class="p">)</span>
    <span class="n">copySingleFiles</span><span class="p">(</span><span class="n">template_dir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">code_dir</span><span class="p">,</span> <span class="s1">&#39;scripts&#39;</span><span class="p">),</span> <span class="s1">r&#39;.R&#39;</span><span class="p">,</span>
                    <span class="s1">r&#39;.py&#39;</span><span class="p">)</span>

    <span class="c1"># Replace all instances of template with &#39;name&#39; from project_&#39;name&#39; as</span>
    <span class="c1"># specified in options:</span>
    <span class="k">def</span> <span class="nf">renameTree</span><span class="p">(</span><span class="n">full_path</span><span class="p">,</span> <span class="n">old_substring</span><span class="p">,</span> <span class="n">new_substring</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        rename &#39;template&#39; to &#39;project&#39; from template file names</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">dirpath</span><span class="p">,</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">full_path</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirname</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">d</span><span class="p">)):</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">old_substring</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">f</span><span class="p">),</span>
                                  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_substring</span><span class="p">,</span>
                                        <span class="n">f</span><span class="s1">&#39;</span><span class="si">{new_substring}</span><span class="s1">&#39;</span><span class="p">))</span>
                                  <span class="p">)</span>

            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirname</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">old_substring</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dirpath</span><span class="p">),</span> <span class="n">d</span><span class="p">),</span>
                              <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dirpath</span><span class="p">),</span> <span class="n">d</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                                  <span class="n">old_substring</span><span class="p">,</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{new_substring}</span><span class="s1">&#39;</span><span class="p">))</span>
                              <span class="p">)</span>
    <span class="n">renameTree</span><span class="p">(</span><span class="n">project_dir</span><span class="p">,</span> <span class="s1">&#39;template&#39;</span><span class="p">,</span> <span class="n">project_name</span><span class="p">)</span>

<span class="c1"># TO DO: how to find the data python package file? See above, check CGAT</span>
<span class="c1"># example.</span>
    <span class="k">def</span> <span class="nf">scriptTemplate</span><span class="p">():</span>
        <span class="sd">&#39;&#39;&#39; Copy script templates and rename</span>
<span class="sd">            them according to option given</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">code_dir</span> <span class="o">=</span> <span class="n">getDir</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">code_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--script-python&#39;</span><span class="p">]:</span>
           <span class="c1"># copy_to = os.path.join(code_dir, &#39;scripts&#39;, str(script_name + &#39;.py&#39;))</span>
            <span class="n">copy_to</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(),</span> <span class="nb">str</span><span class="p">(</span><span class="n">script_name</span> <span class="o">+</span> <span class="s1">&#39;.py&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">copy_to</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--force&#39;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">docopt_error_msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="s1">&#39;&#39;&#39; File </span><span class="si">{}</span><span class="s1"> already exists - not overwriting,</span>
<span class="s1">                              see --help or use --force to overwrite.</span>
<span class="s1">                              &#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">script_name</span><span class="p">)</span>
                              <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">copy_from</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">template_dir</span><span class="p">,</span> <span class="n">script_template_py</span><span class="p">)</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">copy_from</span><span class="p">,</span> <span class="n">copy_to</span><span class="p">)</span>
                <span class="c1">#os.rename(os.path.join(copy_to, script_template_py),</span>
                <span class="c1">#          filename.replace(&#39;template&#39;, {})).format(script_name)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">symlink</span><span class="p">(</span><span class="n">copy_to</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>

        <span class="k">elif</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--script-R&#39;</span><span class="p">]:</span>
            <span class="n">copy_to</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">code_dir</span><span class="p">,</span> <span class="s1">&#39;scripts&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">script_name</span> <span class="o">+</span> <span class="s1">&#39;.R&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">copy_to</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--force&#39;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">docopt_error_msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="s1">&#39;&#39;&#39; File </span><span class="si">{}</span><span class="s1"> already exists - not overwriting,</span>
<span class="s1">                              see --help or use --force to overwrite.</span>
<span class="s1">                              &#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">script_name</span><span class="p">)</span>
                              <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">copy_from</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">template_dir</span><span class="p">,</span> <span class="n">script_template_R</span><span class="p">)</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">copy_from</span><span class="p">,</span> <span class="n">copy_to</span><span class="p">)</span>
               <span class="c1"># os.rename(os.path.join(copy_to, script_template_R),</span>
               <span class="c1">#           filename.replace(&#39;template&#39;,</span>
               <span class="c1">#                            {})).format(script_name)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">symlink</span><span class="p">(</span><span class="n">copy_to</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">docopt_error_msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;&#39;&#39; Bad arguments/options used for script template,</span>
<span class="s1">            try --help&#39;&#39;&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--script-python&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;--script-R&#39;</span><span class="p">]:</span>
        <span class="n">scriptTemplate</span><span class="p">()</span>

    <span class="c1"># Print a nice welcome message (if successful):</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
               <span class="sd">&quot;&quot;&quot; Done, welcome to {0}!</span>

<span class="sd">    The folder structure and files have been successfully copied to</span>
<span class="sd">    {1}</span>

<span class="sd">    Files have been copied &#39;as is&#39;. You can edit the configuration file</span>
<span class="sd">    ({0}.ini, for python packaging) and run:</span>

<span class="sd">    python project_quickstart.py --update</span>

<span class="sd">    to update files with your chosen parameters (note that some files will get</span>
<span class="sd">    overwritten).</span>

<span class="sd">    The folder structure is</span>
<span class="sd">    {2}</span>

<span class="sd">    Remember to back up code, data and manuscript directories (or your equivalent).</span>

<span class="sd">    The directory</span>
<span class="sd">    {3}</span>
<span class="sd">    can be uploaded to a version control system for example</span>
<span class="sd">    (file templates are for GitHub). Link to Travis CI, Zenodo and</span>
<span class="sd">    ReadtheDocs (notes and reminders within the files copied over)</span>
<span class="sd">    if needed.</span>

<span class="sd">    Script templates are in</span>
<span class="sd">    {3}/scripts/</span>

<span class="sd">    You can put scripts and modules here.</span>

<span class="sd">    and pipelines (eg Ruffus/CGAT or others) in</span>
<span class="sd">    {3}/{0}</span>
<span class="sd">    for example.</span>

<span class="sd">    You can work and save results in</span>
<span class="sd">    {6}</span>

<span class="sd">    Sphinx can be used to render your rst documents in</span>
<span class="sd">    {4}</span>

<span class="sd">    Basic rst template files have been generated already.</span>
<span class="sd">    Use sphinxqhickstart if you want a more complete skeleton.</span>

<span class="sd">    Feel free to raise issues, fork or contribute at:</span>

<span class="sd">    https://github.com/AntonioJBT/project_quickstart</span>

<span class="sd">    Have fun!</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">project_root</span><span class="p">,</span>
               <span class="n">project_dir</span><span class="p">,</span>
               <span class="n">tree_dir</span><span class="p">,</span>
               <span class="n">code_dir</span><span class="p">,</span>
               <span class="n">manuscript_dir</span><span class="p">,</span>
               <span class="n">data_dir</span><span class="p">,</span>
               <span class="n">results_dir</span>
               <span class="p">)</span>
    <span class="p">))</span></div>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># if using docopt:</span>
    <span class="c1"># it will check all arguments pass, if not exits with &#39;Usage:&#39;:</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">docopt</span><span class="o">.</span><span class="n">docopt</span><span class="p">(</span><span class="n">__doc__</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prog_version</span><span class="p">))</span>
         <span class="c1"># switch to template from INI with t = string.Template(&#39;$version&#39;) ;</span>
         <span class="c1"># t.substitute({&#39;version&#39;:0.1})</span>
    <span class="c1"># if arguments are valid, run the program:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">main</span><span class="p">(</span><span class="n">options</span><span class="p">))</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Antonio J. Berlanga-Taylor.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
    </div>

    

    
  </body>
</html>